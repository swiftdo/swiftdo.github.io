<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Flutter 自定义 Widget | Swift学习</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.ico">
    <script data-ad-client="ca-pub-4465026491979447" async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="Flutter 自定义 Widget">
    <meta name="image" content="http://blog.oldbird.run/mweb/16155563318031.jpg">
    <meta name="twitter:title" content="Flutter 自定义 Widget">
    <meta name="twitter:description" content="Flutter 自定义 Widget">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="http://blog.oldbird.run/mweb/16155563318031.jpg">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Flutter 自定义 Widget">
    <meta property="og:description" content="Flutter 自定义 Widget">
    <meta property="og:image" content="http://blog.oldbird.run/mweb/16155563318031.jpg">
    <meta property="article:published_time" content="2021-01-11T00:00:00.000Z">
    <meta property="article:tag" content="flutter">
    <meta itemprop="name" content="Flutter 自定义 Widget">
    <meta itemprop="description" content="Flutter 自定义 Widget">
    <meta itemprop="image" content="http://blog.oldbird.run/mweb/16155563318031.jpg">
    <meta name="google-site-verification" content="6EogPdlAJYusvUHenXWXCGX-oVrqdeBnY-WsURHuKAA">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="keywords" content="oldbirds,oldbird,公众号,swift,swift学习,swiftui,flutter,vapor,ios,figma,数据结构,算法,书单,vuepresss,git,yaml,设计模式,编程">
    
    <link rel="preload" href="/assets/css/0.styles.21b631a1.css" as="style"><link rel="preload" href="/assets/js/app.f5d8099c.js" as="script"><link rel="preload" href="/assets/js/3.fe443068.js" as="script"><link rel="preload" href="/assets/js/2.333abca7.js" as="script"><link rel="preload" href="/assets/js/1.09331013.js" as="script"><link rel="preload" href="/assets/js/136.b2811f5f.js" as="script"><link rel="preload" href="/assets/js/34.36196d0f.js" as="script"><link rel="prefetch" href="/assets/js/10.2a7727dc.js"><link rel="prefetch" href="/assets/js/100.ff076da0.js"><link rel="prefetch" href="/assets/js/101.cd42b276.js"><link rel="prefetch" href="/assets/js/102.4dfddae8.js"><link rel="prefetch" href="/assets/js/103.5054affa.js"><link rel="prefetch" href="/assets/js/104.4e81e5cf.js"><link rel="prefetch" href="/assets/js/105.93e04dcf.js"><link rel="prefetch" href="/assets/js/106.d5c4f74a.js"><link rel="prefetch" href="/assets/js/107.b6071381.js"><link rel="prefetch" href="/assets/js/108.40ad044d.js"><link rel="prefetch" href="/assets/js/109.049fa872.js"><link rel="prefetch" href="/assets/js/110.2eaf37d8.js"><link rel="prefetch" href="/assets/js/111.2deef7bc.js"><link rel="prefetch" href="/assets/js/112.9be07078.js"><link rel="prefetch" href="/assets/js/113.ed194797.js"><link rel="prefetch" href="/assets/js/114.4e733d42.js"><link rel="prefetch" href="/assets/js/115.4ef83f0a.js"><link rel="prefetch" href="/assets/js/116.25e4a84a.js"><link rel="prefetch" href="/assets/js/117.0e3c8fa5.js"><link rel="prefetch" href="/assets/js/118.34dbbda2.js"><link rel="prefetch" href="/assets/js/119.331026ac.js"><link rel="prefetch" href="/assets/js/120.cd91837a.js"><link rel="prefetch" href="/assets/js/121.2d45e7a1.js"><link rel="prefetch" href="/assets/js/122.d28ea398.js"><link rel="prefetch" href="/assets/js/123.0cc3e880.js"><link rel="prefetch" href="/assets/js/124.039c8c4a.js"><link rel="prefetch" href="/assets/js/125.373e0f27.js"><link rel="prefetch" href="/assets/js/126.5b010a5c.js"><link rel="prefetch" href="/assets/js/127.107b4995.js"><link rel="prefetch" href="/assets/js/128.ae855e51.js"><link rel="prefetch" href="/assets/js/129.ff418c2d.js"><link rel="prefetch" href="/assets/js/130.a51cecee.js"><link rel="prefetch" href="/assets/js/131.e92b6561.js"><link rel="prefetch" href="/assets/js/132.28aa6922.js"><link rel="prefetch" href="/assets/js/133.0f9bdef3.js"><link rel="prefetch" href="/assets/js/134.697a65d6.js"><link rel="prefetch" href="/assets/js/135.f6691aa5.js"><link rel="prefetch" href="/assets/js/137.d22806e9.js"><link rel="prefetch" href="/assets/js/138.8ab08a8e.js"><link rel="prefetch" href="/assets/js/139.c3afef6f.js"><link rel="prefetch" href="/assets/js/14.179ec236.js"><link rel="prefetch" href="/assets/js/140.bb57b935.js"><link rel="prefetch" href="/assets/js/141.dc6149dc.js"><link rel="prefetch" href="/assets/js/142.8ace1142.js"><link rel="prefetch" href="/assets/js/143.c1369a5d.js"><link rel="prefetch" href="/assets/js/144.2cfa443b.js"><link rel="prefetch" href="/assets/js/145.c86d0f7b.js"><link rel="prefetch" href="/assets/js/146.ea382846.js"><link rel="prefetch" href="/assets/js/147.a544c287.js"><link rel="prefetch" href="/assets/js/148.c0264c21.js"><link rel="prefetch" href="/assets/js/149.3cbebd3e.js"><link rel="prefetch" href="/assets/js/15.1892ad64.js"><link rel="prefetch" href="/assets/js/150.2fc79db8.js"><link rel="prefetch" href="/assets/js/151.5d8c32a2.js"><link rel="prefetch" href="/assets/js/152.4c741dac.js"><link rel="prefetch" href="/assets/js/153.fa8f658c.js"><link rel="prefetch" href="/assets/js/154.e82bae3b.js"><link rel="prefetch" href="/assets/js/155.a1bf9b76.js"><link rel="prefetch" href="/assets/js/156.fdfed16e.js"><link rel="prefetch" href="/assets/js/157.bf3c7084.js"><link rel="prefetch" href="/assets/js/158.ae6a3a70.js"><link rel="prefetch" href="/assets/js/159.6c57ddaf.js"><link rel="prefetch" href="/assets/js/16.64bc8994.js"><link rel="prefetch" href="/assets/js/160.f083f376.js"><link rel="prefetch" href="/assets/js/161.2311ffa4.js"><link rel="prefetch" href="/assets/js/162.e2e5f3c9.js"><link rel="prefetch" href="/assets/js/163.e46b430f.js"><link rel="prefetch" href="/assets/js/164.44f10b76.js"><link rel="prefetch" href="/assets/js/165.ff57b586.js"><link rel="prefetch" href="/assets/js/166.916e37d5.js"><link rel="prefetch" href="/assets/js/167.c621cc18.js"><link rel="prefetch" href="/assets/js/168.87bdddd1.js"><link rel="prefetch" href="/assets/js/169.263374e3.js"><link rel="prefetch" href="/assets/js/17.934b9510.js"><link rel="prefetch" href="/assets/js/170.917a9ab7.js"><link rel="prefetch" href="/assets/js/171.59da867d.js"><link rel="prefetch" href="/assets/js/172.33624348.js"><link rel="prefetch" href="/assets/js/173.7533aa9f.js"><link rel="prefetch" href="/assets/js/174.3839d223.js"><link rel="prefetch" href="/assets/js/175.ef3f3b5f.js"><link rel="prefetch" href="/assets/js/176.3341948d.js"><link rel="prefetch" href="/assets/js/177.1cb4c7ab.js"><link rel="prefetch" href="/assets/js/178.5ff79257.js"><link rel="prefetch" href="/assets/js/179.9d0490e8.js"><link rel="prefetch" href="/assets/js/18.67513bdc.js"><link rel="prefetch" href="/assets/js/180.699a4793.js"><link rel="prefetch" href="/assets/js/181.78681443.js"><link rel="prefetch" href="/assets/js/182.5d9f58f4.js"><link rel="prefetch" href="/assets/js/183.b556717f.js"><link rel="prefetch" href="/assets/js/184.b9cdc4cf.js"><link rel="prefetch" href="/assets/js/185.19d2cbd6.js"><link rel="prefetch" href="/assets/js/186.4d29cecd.js"><link rel="prefetch" href="/assets/js/187.3b498af9.js"><link rel="prefetch" href="/assets/js/188.168982d7.js"><link rel="prefetch" href="/assets/js/189.23ba661c.js"><link rel="prefetch" href="/assets/js/19.eef0cbb0.js"><link rel="prefetch" href="/assets/js/190.86d3dfb9.js"><link rel="prefetch" href="/assets/js/191.397b6b50.js"><link rel="prefetch" href="/assets/js/192.43dbd7fd.js"><link rel="prefetch" href="/assets/js/193.eef2bc22.js"><link rel="prefetch" href="/assets/js/194.65090187.js"><link rel="prefetch" href="/assets/js/195.83dbd4d2.js"><link rel="prefetch" href="/assets/js/196.e09f14b6.js"><link rel="prefetch" href="/assets/js/197.7f4d0d15.js"><link rel="prefetch" href="/assets/js/198.ed16454a.js"><link rel="prefetch" href="/assets/js/199.011b8124.js"><link rel="prefetch" href="/assets/js/20.c112aa3a.js"><link rel="prefetch" href="/assets/js/200.e0cc8991.js"><link rel="prefetch" href="/assets/js/201.7f7bfbf9.js"><link rel="prefetch" href="/assets/js/202.e48415ca.js"><link rel="prefetch" href="/assets/js/203.8f344be0.js"><link rel="prefetch" href="/assets/js/204.752b4d5e.js"><link rel="prefetch" href="/assets/js/205.1bf02f71.js"><link rel="prefetch" href="/assets/js/206.a7a47a07.js"><link rel="prefetch" href="/assets/js/207.83bb1bcc.js"><link rel="prefetch" href="/assets/js/208.87860735.js"><link rel="prefetch" href="/assets/js/209.e2faae34.js"><link rel="prefetch" href="/assets/js/21.048d2081.js"><link rel="prefetch" href="/assets/js/210.d01a60f7.js"><link rel="prefetch" href="/assets/js/211.66555d2a.js"><link rel="prefetch" href="/assets/js/212.eb914ca3.js"><link rel="prefetch" href="/assets/js/213.e2301c9f.js"><link rel="prefetch" href="/assets/js/214.226bf17c.js"><link rel="prefetch" href="/assets/js/215.cb8c446b.js"><link rel="prefetch" href="/assets/js/216.34cb2ecd.js"><link rel="prefetch" href="/assets/js/217.32cfbedb.js"><link rel="prefetch" href="/assets/js/218.1f2e546a.js"><link rel="prefetch" href="/assets/js/219.aaa5b458.js"><link rel="prefetch" href="/assets/js/22.ca3ed97a.js"><link rel="prefetch" href="/assets/js/220.e03c2423.js"><link rel="prefetch" href="/assets/js/221.a5c7a863.js"><link rel="prefetch" href="/assets/js/222.22bb81cd.js"><link rel="prefetch" href="/assets/js/223.a1e42880.js"><link rel="prefetch" href="/assets/js/224.bf248afa.js"><link rel="prefetch" href="/assets/js/225.909e79b3.js"><link rel="prefetch" href="/assets/js/226.a2075c37.js"><link rel="prefetch" href="/assets/js/227.811c554e.js"><link rel="prefetch" href="/assets/js/228.d2b6e08e.js"><link rel="prefetch" href="/assets/js/229.d0d5c137.js"><link rel="prefetch" href="/assets/js/23.a8bac1a7.js"><link rel="prefetch" href="/assets/js/230.38ba2437.js"><link rel="prefetch" href="/assets/js/231.223345ae.js"><link rel="prefetch" href="/assets/js/232.387012b2.js"><link rel="prefetch" href="/assets/js/233.c32af8c7.js"><link rel="prefetch" href="/assets/js/234.10b252c2.js"><link rel="prefetch" href="/assets/js/235.55f64b47.js"><link rel="prefetch" href="/assets/js/236.55f663a2.js"><link rel="prefetch" href="/assets/js/237.c3d5fca4.js"><link rel="prefetch" href="/assets/js/238.73cd2357.js"><link rel="prefetch" href="/assets/js/239.0071f916.js"><link rel="prefetch" href="/assets/js/24.126ddf6d.js"><link rel="prefetch" href="/assets/js/240.96e42673.js"><link rel="prefetch" href="/assets/js/241.99fedc6b.js"><link rel="prefetch" href="/assets/js/242.26cc903b.js"><link rel="prefetch" href="/assets/js/243.39e2c452.js"><link rel="prefetch" href="/assets/js/244.64d633a0.js"><link rel="prefetch" href="/assets/js/245.a3b2f55e.js"><link rel="prefetch" href="/assets/js/246.767f75c9.js"><link rel="prefetch" href="/assets/js/247.c3a4d313.js"><link rel="prefetch" href="/assets/js/248.55cd23f8.js"><link rel="prefetch" href="/assets/js/249.eb486c0e.js"><link rel="prefetch" href="/assets/js/25.db08cc9c.js"><link rel="prefetch" href="/assets/js/250.77add66b.js"><link rel="prefetch" href="/assets/js/251.6c83df8e.js"><link rel="prefetch" href="/assets/js/252.71f6347e.js"><link rel="prefetch" href="/assets/js/253.9cf89afa.js"><link rel="prefetch" href="/assets/js/254.80c4c882.js"><link rel="prefetch" href="/assets/js/255.57e6efeb.js"><link rel="prefetch" href="/assets/js/256.577bc978.js"><link rel="prefetch" href="/assets/js/257.38354bb3.js"><link rel="prefetch" href="/assets/js/258.93634aae.js"><link rel="prefetch" href="/assets/js/259.d29ea85f.js"><link rel="prefetch" href="/assets/js/26.9e001bfc.js"><link rel="prefetch" href="/assets/js/260.0e088055.js"><link rel="prefetch" href="/assets/js/261.ccc0678d.js"><link rel="prefetch" href="/assets/js/262.ef9286e9.js"><link rel="prefetch" href="/assets/js/263.8f3ccae6.js"><link rel="prefetch" href="/assets/js/264.74c26ff7.js"><link rel="prefetch" href="/assets/js/265.28f0ed27.js"><link rel="prefetch" href="/assets/js/266.9d75e3f7.js"><link rel="prefetch" href="/assets/js/267.5e9985cf.js"><link rel="prefetch" href="/assets/js/268.35d0f69a.js"><link rel="prefetch" href="/assets/js/269.abbae5d9.js"><link rel="prefetch" href="/assets/js/27.8616dfea.js"><link rel="prefetch" href="/assets/js/270.6ac0964c.js"><link rel="prefetch" href="/assets/js/271.80ff5da4.js"><link rel="prefetch" href="/assets/js/272.1a1b453b.js"><link rel="prefetch" href="/assets/js/273.37fa8693.js"><link rel="prefetch" href="/assets/js/274.e89a96db.js"><link rel="prefetch" href="/assets/js/275.4ed7d8c1.js"><link rel="prefetch" href="/assets/js/276.bd918419.js"><link rel="prefetch" href="/assets/js/277.a234777a.js"><link rel="prefetch" href="/assets/js/278.02c3ea30.js"><link rel="prefetch" href="/assets/js/279.940e73c1.js"><link rel="prefetch" href="/assets/js/28.7f9106d6.js"><link rel="prefetch" href="/assets/js/280.93b21f36.js"><link rel="prefetch" href="/assets/js/281.f4e623c1.js"><link rel="prefetch" href="/assets/js/282.99f84a7d.js"><link rel="prefetch" href="/assets/js/283.f21f2ebb.js"><link rel="prefetch" href="/assets/js/284.6b27617f.js"><link rel="prefetch" href="/assets/js/285.3a3cf780.js"><link rel="prefetch" href="/assets/js/286.bf79246c.js"><link rel="prefetch" href="/assets/js/287.aadee283.js"><link rel="prefetch" href="/assets/js/288.7beb488d.js"><link rel="prefetch" href="/assets/js/289.527b3e32.js"><link rel="prefetch" href="/assets/js/29.a622c1c4.js"><link rel="prefetch" href="/assets/js/290.d75b08ba.js"><link rel="prefetch" href="/assets/js/291.6b657fd9.js"><link rel="prefetch" href="/assets/js/292.ab663572.js"><link rel="prefetch" href="/assets/js/293.88999cc7.js"><link rel="prefetch" href="/assets/js/294.d46e439f.js"><link rel="prefetch" href="/assets/js/295.26ae7fce.js"><link rel="prefetch" href="/assets/js/296.117dc93d.js"><link rel="prefetch" href="/assets/js/297.46c76605.js"><link rel="prefetch" href="/assets/js/298.f3d1caab.js"><link rel="prefetch" href="/assets/js/299.cdb8bf79.js"><link rel="prefetch" href="/assets/js/30.6c4d25d5.js"><link rel="prefetch" href="/assets/js/300.b4555cf1.js"><link rel="prefetch" href="/assets/js/301.781b9fdc.js"><link rel="prefetch" href="/assets/js/302.9037f55f.js"><link rel="prefetch" href="/assets/js/303.4087dc00.js"><link rel="prefetch" href="/assets/js/304.ed27992c.js"><link rel="prefetch" href="/assets/js/305.456a6a45.js"><link rel="prefetch" href="/assets/js/306.4b9f7402.js"><link rel="prefetch" href="/assets/js/307.d80ba436.js"><link rel="prefetch" href="/assets/js/308.d42feef6.js"><link rel="prefetch" href="/assets/js/309.834004f2.js"><link rel="prefetch" href="/assets/js/31.3f271932.js"><link rel="prefetch" href="/assets/js/310.6e5dcc5e.js"><link rel="prefetch" href="/assets/js/311.3162f38f.js"><link rel="prefetch" href="/assets/js/312.24aacb4e.js"><link rel="prefetch" href="/assets/js/313.b52d1f55.js"><link rel="prefetch" href="/assets/js/314.59e70a86.js"><link rel="prefetch" href="/assets/js/315.64305119.js"><link rel="prefetch" href="/assets/js/316.9eb79a70.js"><link rel="prefetch" href="/assets/js/317.28ed003f.js"><link rel="prefetch" href="/assets/js/318.6a464492.js"><link rel="prefetch" href="/assets/js/319.74fad84d.js"><link rel="prefetch" href="/assets/js/32.e8a00280.js"><link rel="prefetch" href="/assets/js/320.ab890ed2.js"><link rel="prefetch" href="/assets/js/321.510429ee.js"><link rel="prefetch" href="/assets/js/322.71e8d6f0.js"><link rel="prefetch" href="/assets/js/323.edc66ed1.js"><link rel="prefetch" href="/assets/js/324.f95f9894.js"><link rel="prefetch" href="/assets/js/325.4038c8de.js"><link rel="prefetch" href="/assets/js/326.1f4459df.js"><link rel="prefetch" href="/assets/js/33.df11a54e.js"><link rel="prefetch" href="/assets/js/35.6bed82d1.js"><link rel="prefetch" href="/assets/js/36.3277f5f0.js"><link rel="prefetch" href="/assets/js/37.cce44f1d.js"><link rel="prefetch" href="/assets/js/38.0e7e17c8.js"><link rel="prefetch" href="/assets/js/39.d8604f80.js"><link rel="prefetch" href="/assets/js/4.26becfc9.js"><link rel="prefetch" href="/assets/js/40.7d6162bc.js"><link rel="prefetch" href="/assets/js/41.2f9fca85.js"><link rel="prefetch" href="/assets/js/42.046db2a6.js"><link rel="prefetch" href="/assets/js/43.678226ef.js"><link rel="prefetch" href="/assets/js/44.53aa25f6.js"><link rel="prefetch" href="/assets/js/45.134dce27.js"><link rel="prefetch" href="/assets/js/46.17e59aa5.js"><link rel="prefetch" href="/assets/js/47.2ede5b0e.js"><link rel="prefetch" href="/assets/js/48.ea767660.js"><link rel="prefetch" href="/assets/js/49.0378118e.js"><link rel="prefetch" href="/assets/js/5.da4c3ffc.js"><link rel="prefetch" href="/assets/js/50.f8fe3704.js"><link rel="prefetch" href="/assets/js/51.cffd9d00.js"><link rel="prefetch" href="/assets/js/52.30f6cf40.js"><link rel="prefetch" href="/assets/js/53.d7807f12.js"><link rel="prefetch" href="/assets/js/54.63044d6c.js"><link rel="prefetch" href="/assets/js/55.40b15fb0.js"><link rel="prefetch" href="/assets/js/56.24877a27.js"><link rel="prefetch" href="/assets/js/57.ab790651.js"><link rel="prefetch" href="/assets/js/58.91f066d0.js"><link rel="prefetch" href="/assets/js/59.3c810c3b.js"><link rel="prefetch" href="/assets/js/6.1d628d80.js"><link rel="prefetch" href="/assets/js/60.a62bc58a.js"><link rel="prefetch" href="/assets/js/61.a1f65cab.js"><link rel="prefetch" href="/assets/js/62.856a1241.js"><link rel="prefetch" href="/assets/js/63.1a2216de.js"><link rel="prefetch" href="/assets/js/64.3c5e9cd4.js"><link rel="prefetch" href="/assets/js/65.067ef8c6.js"><link rel="prefetch" href="/assets/js/66.a862e587.js"><link rel="prefetch" href="/assets/js/67.dc3439db.js"><link rel="prefetch" href="/assets/js/68.356fdc53.js"><link rel="prefetch" href="/assets/js/69.d3c1be9c.js"><link rel="prefetch" href="/assets/js/7.82612638.js"><link rel="prefetch" href="/assets/js/70.8ec8a46c.js"><link rel="prefetch" href="/assets/js/71.e9c4f758.js"><link rel="prefetch" href="/assets/js/72.5cff73cf.js"><link rel="prefetch" href="/assets/js/73.d9fc4efc.js"><link rel="prefetch" href="/assets/js/74.7ada5acc.js"><link rel="prefetch" href="/assets/js/75.f4c3f6b1.js"><link rel="prefetch" href="/assets/js/76.88a18d4f.js"><link rel="prefetch" href="/assets/js/77.97ce3709.js"><link rel="prefetch" href="/assets/js/78.92540989.js"><link rel="prefetch" href="/assets/js/79.f43a5f97.js"><link rel="prefetch" href="/assets/js/8.0d3f5ec9.js"><link rel="prefetch" href="/assets/js/80.87396f4c.js"><link rel="prefetch" href="/assets/js/81.b2be9a8b.js"><link rel="prefetch" href="/assets/js/82.b79776b4.js"><link rel="prefetch" href="/assets/js/83.c9b693eb.js"><link rel="prefetch" href="/assets/js/84.b2c0d808.js"><link rel="prefetch" href="/assets/js/85.e30a4051.js"><link rel="prefetch" href="/assets/js/86.6290b650.js"><link rel="prefetch" href="/assets/js/87.44ee4eaa.js"><link rel="prefetch" href="/assets/js/88.d76b3dd5.js"><link rel="prefetch" href="/assets/js/89.d3320b62.js"><link rel="prefetch" href="/assets/js/9.0f286391.js"><link rel="prefetch" href="/assets/js/90.911d9fd5.js"><link rel="prefetch" href="/assets/js/91.e92d9531.js"><link rel="prefetch" href="/assets/js/92.2d7de507.js"><link rel="prefetch" href="/assets/js/93.484376f0.js"><link rel="prefetch" href="/assets/js/94.a5921be2.js"><link rel="prefetch" href="/assets/js/95.38937b70.js"><link rel="prefetch" href="/assets/js/96.1b771706.js"><link rel="prefetch" href="/assets/js/97.4e4945bd.js"><link rel="prefetch" href="/assets/js/98.17e104ba.js"><link rel="prefetch" href="/assets/js/99.dd0d24d0.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.e3370f81.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.e9113b49.js">
    <link rel="stylesheet" href="/assets/css/0.styles.21b631a1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Swift学习</h3> <p class="description" data-v-59e6cb88>过来人的笔记，带你最佳实践，@OldBirds公众号</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>oldbirds</span>
          
        <span data-v-59e6cb88>2020 - </span>
        2024
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Swift学习" class="logo"> <span class="site-name">Swift学习</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Swift
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/swift/swiftui/" class="nav-link"><i class="undefined"></i>
  SwiftUI
</a></li><li class="dropdown-item"><!----> <a href="/swift/ubuntu/" class="nav-link"><i class="undefined"></i>
  Ubuntu中Swift开发
</a></li><li class="dropdown-item"><!----> <a href="/swift/vapor/" class="nav-link"><i class="undefined"></i>
  Vapor
</a></li><li class="dropdown-item"><!----> <a href="/swift/ios/" class="nav-link"><i class="undefined"></i>
  iOS
</a></li><li class="dropdown-item"><!----> <a href="/swift/tips/" class="nav-link"><i class="undefined"></i>
  Tips
</a></li><li class="dropdown-item"><!----> <a href="/swift/fp/" class="nav-link"><i class="undefined"></i>
  函数式编程
</a></li><li class="dropdown-item"><!----> <a href="/swift/better/" class="nav-link"><i class="undefined"></i>
  写更好的Swift代码系列
</a></li><li class="dropdown-item"><!----> <a href="/swift/spm/" class="nav-link"><i class="undefined"></i>
  Swift Package Manage
</a></li></ul></div></div><div class="nav-item"><a href="/flutter/" class="nav-link router-link-active"><i class="undefined"></i>
  Flutter
</a></div><div class="nav-item"><a href="/python/" class="nav-link"><i class="undefined"></i>
  Python
</a></div><div class="nav-item"><a href="/vue/" class="nav-link"><i class="undefined"></i>
  Vue
</a></div><div class="nav-item"><a href="/java/" class="nav-link"><i class="undefined"></i>
  Java
</a></div><div class="nav-item"><a href="https://oldbird.run/design-patterns/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  设计模式
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://oldbird.run/algorithms" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  数据结构与算法
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://oldbird.run/books/#/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  书单
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      其他
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basis/index/" class="nav-link"><i class="undefined"></i>
  概要
</a></li><li class="dropdown-subitem"><a href="/basis/os/" class="nav-link"><i class="undefined"></i>
  操作系统
</a></li></ul></li><li class="dropdown-item"><h4>工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/tools/git/" class="nav-link"><i class="undefined"></i>
  Git
</a></li><li class="dropdown-subitem"><a href="/tools/yaml/" class="nav-link"><i class="undefined"></i>
  YAML
</a></li><li class="dropdown-subitem"><a href="/tools/html/" class="nav-link"><i class="undefined"></i>
  HTML
</a></li><li class="dropdown-subitem"><a href="/tools/plantuml/" class="nav-link"><i class="undefined"></i>
  PlantUML
</a></li><li class="dropdown-subitem"><a href="/tools/flowchart/" class="nav-link"><i class="undefined"></i>
  流程图 Flowchart
</a></li><li class="dropdown-subitem"><a href="/ai/" class="nav-link"><i class="undefined"></i>
  AI
</a></li><li class="dropdown-subitem"><a href="/figma/" class="nav-link"><i class="undefined"></i>
  Figma
</a></li><li class="dropdown-subitem"><a href="/tools/docsify.html" class="nav-link"><i class="undefined"></i>
  docsify
</a></li><li class="dropdown-subitem"><a href="/tools/vuepress/" class="nav-link"><i class="undefined"></i>
  VuePress
</a></li><li class="dropdown-subitem"><a href="/tools/note/" class="nav-link"><i class="undefined"></i>
  Note
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/haskell/" class="nav-link"><i class="undefined"></i>
  Haskell
</a></li><li class="dropdown-item"><h4>C&amp;C++</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/c/program/" class="nav-link"><i class="undefined"></i>
  语言篇
</a></li><li class="dropdown-subitem"><a href="/c/audio/" class="nav-link"><i class="undefined"></i>
  音频篇
</a></li><li class="dropdown-subitem"><a href="/c/cmake/" class="nav-link"><i class="undefined"></i>
  CMake篇
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      关于
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/index/" class="nav-link"><i class="undefined"></i>
  关于我们
</a></li></ul></div></div> <a href="https://github.com/swiftdo/swiftdo.github.io" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="/logo.png" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    oldbirds
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>272</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>45</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Swift
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/swift/swiftui/" class="nav-link"><i class="undefined"></i>
  SwiftUI
</a></li><li class="dropdown-item"><!----> <a href="/swift/ubuntu/" class="nav-link"><i class="undefined"></i>
  Ubuntu中Swift开发
</a></li><li class="dropdown-item"><!----> <a href="/swift/vapor/" class="nav-link"><i class="undefined"></i>
  Vapor
</a></li><li class="dropdown-item"><!----> <a href="/swift/ios/" class="nav-link"><i class="undefined"></i>
  iOS
</a></li><li class="dropdown-item"><!----> <a href="/swift/tips/" class="nav-link"><i class="undefined"></i>
  Tips
</a></li><li class="dropdown-item"><!----> <a href="/swift/fp/" class="nav-link"><i class="undefined"></i>
  函数式编程
</a></li><li class="dropdown-item"><!----> <a href="/swift/better/" class="nav-link"><i class="undefined"></i>
  写更好的Swift代码系列
</a></li><li class="dropdown-item"><!----> <a href="/swift/spm/" class="nav-link"><i class="undefined"></i>
  Swift Package Manage
</a></li></ul></div></div><div class="nav-item"><a href="/flutter/" class="nav-link router-link-active"><i class="undefined"></i>
  Flutter
</a></div><div class="nav-item"><a href="/python/" class="nav-link"><i class="undefined"></i>
  Python
</a></div><div class="nav-item"><a href="/vue/" class="nav-link"><i class="undefined"></i>
  Vue
</a></div><div class="nav-item"><a href="/java/" class="nav-link"><i class="undefined"></i>
  Java
</a></div><div class="nav-item"><a href="https://oldbird.run/design-patterns/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  设计模式
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://oldbird.run/algorithms" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  数据结构与算法
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://oldbird.run/books/#/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  书单
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      其他
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basis/index/" class="nav-link"><i class="undefined"></i>
  概要
</a></li><li class="dropdown-subitem"><a href="/basis/os/" class="nav-link"><i class="undefined"></i>
  操作系统
</a></li></ul></li><li class="dropdown-item"><h4>工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/tools/git/" class="nav-link"><i class="undefined"></i>
  Git
</a></li><li class="dropdown-subitem"><a href="/tools/yaml/" class="nav-link"><i class="undefined"></i>
  YAML
</a></li><li class="dropdown-subitem"><a href="/tools/html/" class="nav-link"><i class="undefined"></i>
  HTML
</a></li><li class="dropdown-subitem"><a href="/tools/plantuml/" class="nav-link"><i class="undefined"></i>
  PlantUML
</a></li><li class="dropdown-subitem"><a href="/tools/flowchart/" class="nav-link"><i class="undefined"></i>
  流程图 Flowchart
</a></li><li class="dropdown-subitem"><a href="/ai/" class="nav-link"><i class="undefined"></i>
  AI
</a></li><li class="dropdown-subitem"><a href="/figma/" class="nav-link"><i class="undefined"></i>
  Figma
</a></li><li class="dropdown-subitem"><a href="/tools/docsify.html" class="nav-link"><i class="undefined"></i>
  docsify
</a></li><li class="dropdown-subitem"><a href="/tools/vuepress/" class="nav-link"><i class="undefined"></i>
  VuePress
</a></li><li class="dropdown-subitem"><a href="/tools/note/" class="nav-link"><i class="undefined"></i>
  Note
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/haskell/" class="nav-link"><i class="undefined"></i>
  Haskell
</a></li><li class="dropdown-item"><h4>C&amp;C++</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/c/program/" class="nav-link"><i class="undefined"></i>
  语言篇
</a></li><li class="dropdown-subitem"><a href="/c/audio/" class="nav-link"><i class="undefined"></i>
  音频篇
</a></li><li class="dropdown-subitem"><a href="/c/cmake/" class="nav-link"><i class="undefined"></i>
  CMake篇
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      关于
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/index/" class="nav-link"><i class="undefined"></i>
  关于我们
</a></li></ul></div></div> <a href="https://github.com/swiftdo/swiftdo.github.io" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Flutter</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/flutter/" aria-current="page" class="sidebar-link">flutter</a></li><li><a href="/flutter/point.html" class="sidebar-link">Flutter必备点</a></li><li><a href="/flutter/t1-tips.html" class="sidebar-link">tips</a></li><li><a href="/flutter/t2-what.html" class="sidebar-link">什么是 Widgets、RenderObjects 和 Elements？</a></li><li><a href="/flutter/t3-messages.html" class="sidebar-link">Flutter中的通信传值</a></li><li><a href="/flutter/t3-mixin.html" class="sidebar-link">分离 View 与 Model 方案之 mixin</a></li><li><a href="/flutter/t4-lifecycle.html" class="sidebar-link">生命周期</a></li><li><a href="/flutter/t5-flutter-web-deploy.html" class="sidebar-link">在 Github 上部署一个 Flutter Web 应用</a></li><li><a href="/flutter/t6-docker-web-deploy.html" class="sidebar-link">在 Docker 上部署一个 Flutter Web 应用</a></li><li><a href="/flutter/t7-fvm.html" class="sidebar-link">Flutter之 FVM 版本管理</a></li><li><a href="/flutter/t8-const.html" class="sidebar-link">Flutter 中 const 使用</a></li><li><a href="/flutter/t9-logs.html" class="sidebar-link">Flutter 提交日志搜集</a></li><li><a href="/flutter/u10-fvm-flutter2.html" class="sidebar-link">Flutter 2.0 顺滑撤回，web 初体验</a></li><li><a href="/flutter/u11-flutter-render.html" class="sidebar-link">Flutter 是如何渲染的？</a></li><li><a href="/flutter/u12-flutter-create-w.html" aria-current="page" class="active sidebar-link">Flutter 自定义 Widget</a></li><li><a href="/flutter/u12-flutter-web-01.html" class="sidebar-link">Flutter for Web，网络篇</a></li><li><a href="/flutter/u12-flutter-web-02.html" class="sidebar-link">Flutter2 for Web，跨域篇</a></li><li><a href="/flutter/u13-sliverappbar.html" class="sidebar-link">SliverAppBar 常用属性</a></li><li><a href="/flutter/u14-navbar-color.html" class="sidebar-link">状态栏颜色设置</a></li><li><a href="/flutter/u15-custom-nabar.html" class="sidebar-link">高度自定义 navbar 联动动效</a></li><li><a href="/flutter/u16-shape.html" class="sidebar-link">自定义 ShapeBorder</a></li><li><a href="/flutter/y1-statubar.html" class="sidebar-link">Flutter隐藏顶部状态栏</a></li><li><a href="/flutter/github-actions-build-flutter-ios.html" class="sidebar-link">Github Actions 免费构建 Flutter iOS 包</a></li><li><a href="/flutter/github-actions-build-flutter-android.html" class="sidebar-link">Github Actions 免费构建 Flutter Android 包</a></li><li><a href="/flutter/flutter-color.html" class="sidebar-link">Flutter 关于颜色的几个补充，非常实用</a></li><li><a href="/flutter/flutter-dialog.html" class="sidebar-link">Flutter Dialog 的使用</a></li><li><a href="/flutter/flutter-deps.html" class="sidebar-link">Flutter 查看库的依赖关系</a></li><li><a href="/flutter/flutter-screenshoot1.html" class="sidebar-link">Flutter Widget 截图(一)</a></li><li><a href="/flutter/flutter-screenshoot2.html" class="sidebar-link">Flutter Widget 截图(二)</a></li><li><a href="/flutter/flutter-screenshoot3.html" class="sidebar-link">Flutter Widget 截图(三)</a></li><li><a href="/flutter/flutter-repaintBoundary.html" class="sidebar-link">Flutter RepaintBoundary</a></li><li><a href="/flutter/flutter-isolate.html" class="sidebar-link">Flutter 多线程</a></li><li><a href="/flutter/flutter-vscode-config.html" class="sidebar-link">Flutter VSCode 设置启动参数</a></li><li><a href="/flutter/flutter-web-launch-page.html" class="sidebar-link">Flutter for Web 自定义启动加载页面</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Flutter 自定义 Widget</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>oldbirds</span>
          
        <span data-v-59e6cb88>2020 - </span>
        2024
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">Flutter 自定义 Widget</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>oldbirds</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>1/11/2021</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>flutter</span></i></div></div> <div class="theme-reco-content content__default"><p>Flutter 自定义 Widget</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token class-name">Everything</span>’s a widget
</code></pre></div><p>在 Flutter 中，我们无时无刻不跟 Widget 打交道，我们可以通过组合 Flutter 提供的基础 Widget 实现丰富的 UI 效果。但是作为一名程序员，我们不会满足于此，我们总有一颗好奇的心，想去探究它的原理，希望做到知其然且知其所以然。</p> <p>所以本文将和大家一起揭开 Widget 的神秘面纱，探寻背后藏着的黑箱子。</p> <h2 id="从-opcity-触发"><a href="#从-opcity-触发" class="header-anchor">#</a> 从 Opcity 触发</h2> <p>我们将通过观察 Opcity Widget 来找出一些门道。<a href="https://github.com/flutter/flutter/blob/f38743593d00f13b21f49d8d8ee2d2206bf820d3/packages/flutter/lib/src/widgets/basic.dart#L150" target="_blank" rel="nofollow noopener noreferrer">Opacity<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 是个非常基础的 Widget，代码也比较简单，软柿子一枚，分析起来会相对容易。</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">class</span> <span class="token class-name">Opacity</span> <span class="token keyword">extends</span> <span class="token class-name">SingleChildRenderObjectWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token class-name">Opacity</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token class-name">Key</span><span class="token operator">?</span> key<span class="token punctuation">,</span>
    required <span class="token keyword">this</span><span class="token punctuation">.</span>opacity<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>alwaysIncludeSemantics <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token class-name">Widget</span><span class="token operator">?</span> child<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">assert</span><span class="token punctuation">(</span>opacity <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> opacity <span class="token operator">&gt;=</span> <span class="token number">0.0</span> <span class="token operator">&amp;&amp;</span> opacity <span class="token operator">&lt;=</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token keyword">assert</span><span class="token punctuation">(</span>alwaysIncludeSemantics <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token keyword">super</span><span class="token punctuation">(</span>key<span class="token punctuation">:</span> key<span class="token punctuation">,</span> child<span class="token punctuation">:</span> child<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">final</span> double opacity<span class="token punctuation">;</span>
  <span class="token keyword">final</span> bool alwaysIncludeSemantics<span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">RenderOpacity</span> <span class="token function">createRenderObject</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">RenderOpacity</span><span class="token punctuation">(</span>
      opacity<span class="token punctuation">:</span> opacity<span class="token punctuation">,</span>
      alwaysIncludeSemantics<span class="token punctuation">:</span> alwaysIncludeSemantics<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">updateRenderObject</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">,</span> <span class="token class-name">RenderOpacity</span> renderObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    renderObject
      <span class="token punctuation">.</span><span class="token punctuation">.</span>opacity <span class="token operator">=</span> opacity
      <span class="token punctuation">.</span><span class="token punctuation">.</span>alwaysIncludeSemantics <span class="token operator">=</span> alwaysIncludeSemantics<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">debugFillProperties</span><span class="token punctuation">(</span><span class="token class-name">DiagnosticPropertiesBuilder</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">debugFillProperties</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
    properties<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">DoubleProperty</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'opacity'</span></span><span class="token punctuation">,</span> opacity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    properties<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">FlagProperty</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'alwaysIncludeSemantics'</span></span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> alwaysIncludeSemantics<span class="token punctuation">,</span> ifTrue<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'alwaysIncludeSemantics'</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Opacity 只接受一个子 Widget。可以用 Opacity 来包装任何 Widget 并调整其显示方式。除了 child 参数，只有另外一个 opacity 参数，它是浮点类型，值介于 0.0 和 1.0。这个参数用于控制不透明度。</p> <p>Opacity 的继承结构如下：</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token class-name">Opacity</span> → <span class="token class-name">SingleChildRenderObjectWidget</span> → <span class="token class-name">RenderObjectWidget</span> → <span class="token class-name">Widget</span>
</code></pre></div><p>通常我们在使用自定义 Widget 的时候，都是继承 StatelessWidget/StatefulWidget。它们的继承结构则是：</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token class-name">StatelessWidget</span><span class="token operator">/</span><span class="token class-name">StatefulWidget</span> → <span class="token class-name">Widget</span>
</code></pre></div><p>我们也很容易发现 StatelessWidget/StatefulWidget 更多的是组合其他 Widget, 但是 Opcity 却改变了 Widget 的绘制方式。</p> <p>我们在 Widget 中找不到跟实际绘制的任何相关代码。原因在于 Widget 只是一份配置信息，所以它的创建成本并不高。</p> <p>那么 Opacity 的渲染发生在哪里？通过名字我们可以猜到 RenderObject 负责渲染工作。在 Opacity 中：</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">/// 创建 renderObject</span>
<span class="token metadata function">@override</span>
<span class="token class-name">RenderOpacity</span> <span class="token function">createRenderObject</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">RenderOpacity</span><span class="token punctuation">(</span>
      opacity<span class="token punctuation">:</span> opacity<span class="token punctuation">,</span>
      alwaysIncludeSemantics<span class="token punctuation">:</span> alwaysIncludeSemantics<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/// 更新 renderObject</span>
<span class="token metadata function">@override</span>
<span class="token keyword">void</span> <span class="token function">updateRenderObject</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">,</span> <span class="token class-name">RenderOpacity</span> renderObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    renderObject
      <span class="token punctuation">.</span><span class="token punctuation">.</span>opacity <span class="token operator">=</span> opacity
      <span class="token punctuation">.</span><span class="token punctuation">.</span>alwaysIncludeSemantics <span class="token operator">=</span> alwaysIncludeSemantics<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="renderopacity"><a href="#renderopacity" class="header-anchor">#</a> RenderOpacity</h3> <p>Opacity Widget 大小跟其 child 完全一样。基本上它每个方面跟其 child 都一样，除了绘制，它会在绘制 child 前加上不透明度。</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">class</span> <span class="token class-name">RenderOpacity</span> <span class="token keyword">extends</span> <span class="token class-name">RenderProxyBox</span> <span class="token punctuation">{</span>
  <span class="token class-name">RenderOpacity</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    double opacity <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
    bool alwaysIncludeSemantics <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token class-name">RenderBox</span><span class="token operator">?</span> child<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">assert</span><span class="token punctuation">(</span>opacity <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token keyword">assert</span><span class="token punctuation">(</span>opacity <span class="token operator">&gt;=</span> <span class="token number">0.0</span> <span class="token operator">&amp;&amp;</span> opacity <span class="token operator">&lt;=</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token keyword">assert</span><span class="token punctuation">(</span>alwaysIncludeSemantics <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       _opacity <span class="token operator">=</span> opacity<span class="token punctuation">,</span>
       _alwaysIncludeSemantics <span class="token operator">=</span> alwaysIncludeSemantics<span class="token punctuation">,</span>
       _alpha <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">ui<span class="token punctuation">.</span></span>Color</span><span class="token punctuation">.</span><span class="token function">getAlphaFromOpacity</span><span class="token punctuation">(</span>opacity<span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token keyword">super</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  bool <span class="token keyword">get</span> alwaysNeedsCompositing <span class="token operator">=</span><span class="token operator">&gt;</span> child <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>_alpha <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> _alpha <span class="token operator">!=</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  int _alpha<span class="token punctuation">;</span>

  double <span class="token keyword">get</span> opacity <span class="token operator">=</span><span class="token operator">&gt;</span> _opacity<span class="token punctuation">;</span>
  double _opacity<span class="token punctuation">;</span>
  <span class="token keyword">set</span> <span class="token function">opacity</span><span class="token punctuation">(</span>double value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">assert</span><span class="token punctuation">(</span>value <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span><span class="token punctuation">(</span>value <span class="token operator">&gt;=</span> <span class="token number">0.0</span> <span class="token operator">&amp;&amp;</span> value <span class="token operator">&lt;=</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_opacity <span class="token operator">==</span> value<span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> bool didNeedCompositing <span class="token operator">=</span> alwaysNeedsCompositing<span class="token punctuation">;</span>
    <span class="token keyword">final</span> bool wasVisible <span class="token operator">=</span> _alpha <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    _opacity <span class="token operator">=</span> value<span class="token punctuation">;</span>
    _alpha <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">ui<span class="token punctuation">.</span></span>Color</span><span class="token punctuation">.</span><span class="token function">getAlphaFromOpacity</span><span class="token punctuation">(</span>_opacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>didNeedCompositing <span class="token operator">!=</span> alwaysNeedsCompositing<span class="token punctuation">)</span>
      <span class="token function">markNeedsCompositingBitsUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">markNeedsPaint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>wasVisible <span class="token operator">!=</span> <span class="token punctuation">(</span>_alpha <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>alwaysIncludeSemantics<span class="token punctuation">)</span>
      <span class="token function">markNeedsSemanticsUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  bool <span class="token keyword">get</span> alwaysIncludeSemantics <span class="token operator">=</span><span class="token operator">&gt;</span> _alwaysIncludeSemantics<span class="token punctuation">;</span>
  bool _alwaysIncludeSemantics<span class="token punctuation">;</span>
  <span class="token keyword">set</span> <span class="token function">alwaysIncludeSemantics</span><span class="token punctuation">(</span>bool value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> _alwaysIncludeSemantics<span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    _alwaysIncludeSemantics <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token function">markNeedsSemanticsUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">paint</span><span class="token punctuation">(</span><span class="token class-name">PaintingContext</span> context<span class="token punctuation">,</span> <span class="token class-name">Offset</span> offset<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>child <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>_alpha <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        layer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>_alpha <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        layer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">paintChild</span><span class="token punctuation">(</span>child<span class="token operator">!</span><span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">assert</span><span class="token punctuation">(</span>needsCompositing<span class="token punctuation">)</span><span class="token punctuation">;</span>
      layer <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">pushOpacity</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> _alpha<span class="token punctuation">,</span> <span class="token keyword">super</span><span class="token punctuation">.</span>paint<span class="token punctuation">,</span> oldLayer<span class="token punctuation">:</span> layer <span class="token operator">as</span> <span class="token class-name">OpacityLayer</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">visitChildrenForSemantics</span><span class="token punctuation">(</span><span class="token class-name">RenderObjectVisitor</span> visitor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>child <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>_alpha <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> alwaysIncludeSemantics<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token function">visitor</span><span class="token punctuation">(</span>child<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">debugFillProperties</span><span class="token punctuation">(</span><span class="token class-name">DiagnosticPropertiesBuilder</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">debugFillProperties</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
    properties<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">DoubleProperty</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'opacity'</span></span><span class="token punctuation">,</span> opacity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    properties<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">FlagProperty</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'alwaysIncludeSemantics'</span></span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> alwaysIncludeSemantics<span class="token punctuation">,</span> ifTrue<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'alwaysIncludeSemantics'</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>RenderOpacity</code> 继承自 <code>RenderProxyBox</code>，在 <code>opacity</code> 的 setter 方法中，它调用了 markNeedsPaint() 和 markNeedsLayout() 方法。这个方法告诉系统重新绘制和重新布局。</p> <p>在 <code>paint</code> 方法里：</p> <div class="language-dart extra-class"><pre class="language-dart"><code>context<span class="token punctuation">.</span><span class="token function">pushOpacity</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> _alpha<span class="token punctuation">,</span> <span class="token keyword">super</span><span class="token punctuation">.</span>paint<span class="token punctuation">,</span> oldLayer<span class="token punctuation">:</span> layer <span class="token operator">as</span> <span class="token class-name">OpacityLayer</span><span class="token operator">?</span><span class="token punctuation">)</span>
</code></pre></div><p>其中 <code>context</code> 是一个高级的 canvas。这行代码就是不透明度的实现。</p> <p>最后从 Opacity 中，我们可以总结如下：</p> <ul><li>Opacity 并非继承自 StatelessWidget 或 StatefulWidget, 而是一个 SingleChildRenderObjectWidget</li> <li>Widget 仅持有渲染器会用到的配置信息</li> <li>RenderOpacity 完成实际布局/渲染工作，Widget 布局的核心在于 RenderObject</li> <li>RenderOpacity 覆盖了 paint 方法。在这个方法中调用 pushOpacity() 来为 Widget 添加不透明度</li></ul> <p>到这里我们基本知道 Opacity 大体实现，但是还是有很多疑问对吧？</p> <ul><li>SingleChildRenderObjectWidget 做了啥？</li> <li>不是三棵树么，在 Opacity 只看到 Widget 和 RenderObject，Element 呢？</li> <li>现有的 Widget 的继承结构如何？</li> <li>RenderProxyBox、RenderBox、RenderObject 各自都做了什么?</li></ul> <p>那么接下来，我们一起来解答这些问题。</p> <h2 id="singlechildrenderobjectwidget、renderobjectwidget、widget-各类的职责"><a href="#singlechildrenderobjectwidget、renderobjectwidget、widget-各类的职责" class="header-anchor">#</a> SingleChildRenderObjectWidget、RenderObjectWidget、Widget 各类的职责</h2> <h3 id="widget"><a href="#widget" class="header-anchor">#</a> Widget</h3> <p>首先，我们先来看一下 Widget 类的声明：</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token metadata function">@immutable</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Widget</span> <span class="token keyword">extends</span> <span class="token class-name">DiagnosticableTree</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token class-name">Widget</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">Key</span><span class="token operator">?</span> key<span class="token punctuation">;</span>

  <span class="token metadata function">@protected</span>
  <span class="token metadata function">@factory</span>
  <span class="token class-name">Element</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">String</span> <span class="token function">toStringShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token class-name">String</span> type <span class="token operator">=</span> <span class="token function">objectRuntimeType</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'Widget'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> key <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> type <span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">type</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">key</span></span><span class="token string">'</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">debugFillProperties</span><span class="token punctuation">(</span><span class="token class-name">DiagnosticPropertiesBuilder</span> properties<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">debugFillProperties</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
    properties<span class="token punctuation">.</span>defaultDiagnosticsTreeStyle <span class="token operator">=</span> <span class="token class-name">DiagnosticsTreeStyle</span><span class="token punctuation">.</span>dense<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token metadata function">@override</span>
  <span class="token metadata function">@nonVirtual</span>
  bool <span class="token keyword">operator</span> <span class="token operator">==</span><span class="token punctuation">(</span><span class="token class-name">Object</span> other<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">super</span> <span class="token operator">==</span> other<span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token metadata function">@nonVirtual</span>
  int <span class="token keyword">get</span> hashCode <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">super</span><span class="token punctuation">.</span>hashCode<span class="token punctuation">;</span>

  <span class="token keyword">static</span> bool <span class="token function">canUpdate</span><span class="token punctuation">(</span><span class="token class-name">Widget</span> oldWidget<span class="token punctuation">,</span> <span class="token class-name">Widget</span> newWidget<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> oldWidget<span class="token punctuation">.</span>runtimeType <span class="token operator">==</span> newWidget<span class="token punctuation">.</span>runtimeType
        <span class="token operator">&amp;&amp;</span> oldWidget<span class="token punctuation">.</span>key <span class="token operator">==</span> newWidget<span class="token punctuation">.</span>key<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> int <span class="token function">_debugConcreteSubtype</span><span class="token punctuation">(</span><span class="token class-name">Widget</span> widget<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> widget <span class="token operator">is</span> <span class="token class-name">StatefulWidget</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span>
           widget <span class="token operator">is</span> <span class="token class-name">StatelessWidget</span> <span class="token operator">?</span> <span class="token number">2</span> <span class="token punctuation">:</span>
           <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>从这个 Widget 类的申明中，我们可以得到如下一些信息:</p> <ul><li>Widget 类继承自 DiagnosticableTree，主要作用是提供调试信息。</li> <li>Key: 主要的作用是决定是否在下一次 build 时复用旧的 widget，决定的条件在 canUpdate()方法中</li> <li>createElement()：正如前文所述一个 Widget 可以对应多个 Element；Flutter Framework 在构建 UI 时，会先调用此方法生成对应节点的 Element 对象。此方法是 Flutter Framework 隐式调用的，在我们开发过程中基本不会调用到。</li> <li>debugFillProperties 复写父类的方法，主要是设置 DiagnosticableTree 的一些特性。</li> <li>canUpdate() 是一个静态方法，它主要用于在 Widget 树重新 build 时复用旧的 widget。具体来说，是否使用新的 Widget 对象去更新旧 UI 树上所对应的 Element 对象的配置；并且通过其源码我们可以知道，只要 newWidget 与 oldWidget 的 runtimeType 和 key 同时相等时就会用 newWidget 去更新 Element 对象的配置，否则就会创建新的 Element。</li></ul> <h3 id="renderobjectwidget"><a href="#renderobjectwidget" class="header-anchor">#</a> RenderObjectWidget</h3> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">RenderObjectWidget</span> <span class="token keyword">extends</span> <span class="token class-name">Widget</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token class-name">RenderObjectWidget</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">Key</span><span class="token operator">?</span> key <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">super</span><span class="token punctuation">(</span>key<span class="token punctuation">:</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token metadata function">@factory</span>
  <span class="token class-name">RenderObjectElement</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@protected</span>
  <span class="token metadata function">@factory</span>
  <span class="token class-name">RenderObject</span> <span class="token function">createRenderObject</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@protected</span>
  <span class="token keyword">void</span> <span class="token function">updateRenderObject</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">,</span> <span class="token keyword">covariant</span> <span class="token class-name">RenderObject</span> renderObject<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

  <span class="token metadata function">@protected</span>
  <span class="token keyword">void</span> <span class="token function">didUnmountRenderObject</span><span class="token punctuation">(</span><span class="token keyword">covariant</span> <span class="token class-name">RenderObject</span> renderObject<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>RenderObjectWidget 用来配置 RenderObject。其 createElement() 函数返回 RenderObjectElement。由其子类实现。相对于上面说的其他 Widget。这里多了一个 createRenderObject()方法。用来实例化 RenderObject。</p> <p>RenderObjectWidget 只是个配置，当配置发生变化需要应用到现有的 RenderObject 上的时候，Flutter 框架会调用 updateRenderObject() 来把新的配置设置给相应的 RenderObject。</p> <p>RenderObjectWidget 有三个比较重要的子类：</p> <ul><li>LeafRenderObjectWidget 这个 Widget 配置的节点处于树的最底层，它是没有孩子的。对应 LeafRenderObjectElement。</li> <li>SingleChildRenderObjectWidget，只含有一个孩子。对应 SingleChildRenderObjectElement。</li> <li>MultiChildRenderObjectWidget，有多个孩子。对应 MultiChildRenderObjectElement。</li></ul> <h2 id="现有的-widget-的继承结构如何"><a href="#现有的-widget-的继承结构如何" class="header-anchor">#</a> 现有的 Widget 的继承结构如何？</h2> <p>以下只是部分 widget 的列举，没有列举所有。</p> <h3 id="基本继承关系图"><a href="#基本继承关系图" class="header-anchor">#</a> 基本继承关系图：</h3> <p><img alt="" data-src="http://blog.oldbird.run/mweb/16155563318031.jpg" loading="lazy" class="lazy"></p> <h3 id="leafrenderobjectwidget-继承关系图"><a href="#leafrenderobjectwidget-继承关系图" class="header-anchor">#</a> LeafRenderObjectWidget 继承关系图：</h3> <p><img alt="" data-src="http://blog.oldbird.run/mweb/16155563445065.jpg" loading="lazy" class="lazy"></p> <h3 id="singlechildrenderobjectwidget-继承关系图"><a href="#singlechildrenderobjectwidget-继承关系图" class="header-anchor">#</a> SingleChildRenderObjectWidget 继承关系图</h3> <p><img alt="" data-src="http://blog.oldbird.run/mweb/16155563900589.jpg" loading="lazy" class="lazy"></p> <h3 id="mutilchildrenderobjectwidget-继承关系图"><a href="#mutilchildrenderobjectwidget-继承关系图" class="header-anchor">#</a> MutilChildRenderObjectWidget 继承关系图</h3> <p><img alt="" data-src="http://blog.oldbird.run/mweb/16155564431428.jpg" loading="lazy" class="lazy"></p> <h3 id="proxywidget-继承关系图"><a href="#proxywidget-继承关系图" class="header-anchor">#</a> ProxyWidget 继承关系图</h3> <p><img alt="" data-src="http://blog.oldbird.run/mweb/16155564169235.jpg" loading="lazy" class="lazy"></p> <p>ProxyWidget 作为一个抽象的代理 Widget，并没有实质性的作用。只是在父类和子类需要传递信息时使用；主要有 InheritedWidget 和 ParentDataWidget 两类；InheritedWidget 和 ParentDataWidget 涉及内容较多，后续文章我们再深入研究；</p> <h3 id="statelesswidget-继承关系图"><a href="#statelesswidget-继承关系图" class="header-anchor">#</a> StatelessWidget 继承关系图</h3> <p><img alt="" data-src="http://blog.oldbird.run/mweb/16155564637494.jpg" loading="lazy" class="lazy"></p> <h3 id="statefulwidget-继承关系图"><a href="#statefulwidget-继承关系图" class="header-anchor">#</a> StatefulWidget 继承关系图</h3> <p><img alt="" data-src="http://blog.oldbird.run/mweb/16155564723993.jpg" loading="lazy" class="lazy"></p> <h2 id="opacity-只看到-widget-和-renderobject-element-呢"><a href="#opacity-只看到-widget-和-renderobject-element-呢" class="header-anchor">#</a> Opacity 只看到 Widget 和 RenderObject，Element 呢？</h2> <p>答案是 SingleChildRenderObjectWidget 创建了 Element。</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">SingleChildRenderObjectWidget</span> <span class="token keyword">extends</span> <span class="token class-name">RenderObjectWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token class-name">SingleChildRenderObjectWidget</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">Key</span><span class="token operator">?</span> key<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>child <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">super</span><span class="token punctuation">(</span>key<span class="token punctuation">:</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">final</span> <span class="token class-name">Widget</span><span class="token operator">?</span> child<span class="token punctuation">;</span>

  <span class="token comment">/// 这里创建了 SingleChildRenderObjectElement</span>
  <span class="token metadata function">@override</span>
  <span class="token class-name">SingleChildRenderObjectElement</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token class-name">SingleChildRenderObjectElement</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="widget-树-、renderobject-树、element-树的关系"><a href="#widget-树-、renderobject-树、element-树的关系" class="header-anchor">#</a> Widget 树 、RenderObject 树、Element 树的关系</h3> <p><img alt="" data-src="http://blog.oldbird.run/mweb/16155578964069.jpg" loading="lazy" class="lazy"></p> <p>从上图可以看出，widget 树和 Element 树节点是一一对应关系，每一个 Widget 都会有其对应的 Element，<strong>但是 RenderObject 树则不然，只有需要渲染的 Widget 才会有对应的节点</strong>。Element 树相当于一个中间层，大管家，它对 Widget 和 RenderObject 都有引用。当 Widget 不断变化的时候，将新 Widget 拿到 Element 来进行对比，看一下和之前保留的 Widget 类型和 Key 是否相同，如果都一样，那完全没有必要重新创建 Element 和 RenderObject，只需要更新里面的一些属性即可，这样可以以最小的开销更新 RenderObject，引擎在解析 RenderObject 的时候，发现只有属性修改了，那么也可以以最小的开销来做渲染。</p> <h2 id="renderproxybox、renderbox、renderobject-各自又都做了什么"><a href="#renderproxybox、renderbox、renderobject-各自又都做了什么" class="header-anchor">#</a> RenderProxyBox、RenderBox、RenderObject 各自又都做了什么?</h2> <p>RenderOpacity 的继承关系：</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token class-name">RenderOpacity</span> → <span class="token class-name">RenderProxyBox</span> → <span class="token class-name">RenderBox</span> → <span class="token class-name">RenderObject</span> → <span class="token class-name">AbstractNode</span>
</code></pre></div><h3 id="renderobject"><a href="#renderobject" class="header-anchor">#</a> RenderObject</h3> <p>我们可以通过 Element.renderObject 来获取，并且 RenderObject 的主要职责是布局和绘制，所有的 RenderObject 组成一棵渲染树 Render Tree。</p> <p>RenderObject 类本身实现了一套基础的布局和绘制协议，但是并没有定义子节点模型（如一个节点可以有几个子节点，没有子节点？一个？两个？或者更多？）。 它也没有定义坐标系统（如子节点定位是在笛卡尔坐标中还是极坐标？）和具体的布局协议（是通过宽高还是通过 constraint 和 size?，或者是否由父节点在子节点布局之前或之后设置子节点的大小和位置等）。为此，Flutter 提供了一个 RenderBox 类，它继承自<code>RenderObject</code>，布局坐标系统采用笛卡尔坐标系，这和 Android 和 iOS 原生坐标系是一致的，都是屏幕的左上角是原点，然后分宽高两个轴，大多数情况下，我们直接使用 RenderBox 就可以了，除非遇到要自定义布局模型或坐标系统的情况。</p> <h3 id="renderbox"><a href="#renderbox" class="header-anchor">#</a> RenderBox</h3> <p>如果想更近一步了解 RenderBox, 可参考阅读：</p> <ul><li><a href="https://book.flutterchina.club/chapter14/render_object.html#_14-3-1-%E5%B8%83%E5%B1%80%E8%BF%87%E7%A8%8B" target="_blank" rel="nofollow noopener noreferrer">RenderObject 和 RenderBox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/joahyau/p/12931941.html#%E4%BA%8C%E3%80%81%E5%AE%B9%E5%99%A8%E7%B1%BB%E5%9E%8B%E7%9A%84renderbox" target="_blank" rel="nofollow noopener noreferrer">flutter 的 RenderBox 使用说明书&amp;原理浅析<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>我们在回顾下下我们分析的过程：</p> <ol><li>查看 Opacity 的源码，我们知道 Opacity 的一个继承关系，认识到 Widge 仅仅是个配置，布局和渲染都是 RenderObject 干的活。</li> <li>然后我们整理了 Flutter 常用的 Widget 的继承关系图，知道了 LeafRenderObjectWidget，SingleChildRenderObjectWidget，MultiChildRenderObjectWidget 此类 Widge 的用途。</li> <li>最后分析 RenderObject 的一些子类，从而对 布局和绘制有个初步的了解。</li></ol> <p>整个分析过程下来，我们将会比较清晰的认识到三棵树各自的职责，以及它们之间的关联。</p> <p>为了更具化整个过程，加深对知识点的理解，我们一起来自定义一个 Widget 吧。</p> <h2 id="自定义-widget"><a href="#自定义-widget" class="header-anchor">#</a> 自定义 Widget</h2> <p>完成一个 Widget，是一个圆，圆中心直接显示 OldBirds 文本，且这个圆有个外边框。</p> <p><img alt="效果-w495" data-src="http://blog.oldbird.run/mweb/Screen%20Shot%202021-03-13%20at%2010.11.33%20PM.png" loading="lazy" class="lazy"></p> <p>撸起袖子开干！</p> <p>代码如下：</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">class</span> <span class="token class-name">CircleLogoWidget</span> <span class="token keyword">extends</span> <span class="token class-name">SingleChildRenderObjectWidget</span> <span class="token punctuation">{</span>
  <span class="token metadata function">@override</span>
  <span class="token class-name">RenderObject</span> <span class="token function">createRenderObject</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">CircleLogoRenderBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>使我们的 CircleLogoWidget 继承于 SingleChildRenderObjectWidget 会默认实现一个 createRenderObject 方法，会让你返回一个 RenderObject，这个对象负责对你 Widget 的绘制和布局，我们这边返回 <code>CircleLogoRenderBox</code>：</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token keyword">class</span> <span class="token class-name">CircleLogoRenderBox</span> <span class="token keyword">extends</span> <span class="token class-name">RenderConstrainedBox</span> <span class="token punctuation">{</span>
  <span class="token class-name">CircleLogoRenderBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">super</span><span class="token punctuation">(</span>additionalConstraints<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token class-name">BoxConstraints</span><span class="token punctuation">.</span><span class="token function">tightForFinite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">/// 相应事件是否是当前View，用来处理事件的分发</span>
  <span class="token metadata function">@override</span>
  bool <span class="token function">hitTest</span><span class="token punctuation">(</span><span class="token class-name">BoxHitTestResult</span> result<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token class-name">Offset</span> position<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/// 用来处理用户触摸事件</span>
  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">handleEvent</span><span class="token punctuation">(</span><span class="token class-name">PointerEvent</span> event<span class="token punctuation">,</span> <span class="token keyword">covariant</span> <span class="token class-name">HitTestEntry</span> entry<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">/// 进行绘制</span>
  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">paint</span><span class="token punctuation">(</span><span class="token class-name">PaintingContext</span> context<span class="token punctuation">,</span> <span class="token class-name">Offset</span> offset<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Paint</span> _paint <span class="token operator">=</span> <span class="token class-name">Paint</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>red
      <span class="token punctuation">.</span><span class="token punctuation">.</span>strokeCap <span class="token operator">=</span> <span class="token class-name">StrokeCap</span><span class="token punctuation">.</span>round
      <span class="token punctuation">.</span><span class="token punctuation">.</span>isAntiAlias <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token class-name">PaintingStyle</span><span class="token punctuation">.</span>stroke
      <span class="token punctuation">.</span><span class="token punctuation">.</span>strokeWidth <span class="token operator">=</span> <span class="token number">5.0</span><span class="token punctuation">;</span>

    <span class="token class-name">TextSpan</span> logoSpan <span class="token operator">=</span> <span class="token class-name">TextSpan</span><span class="token punctuation">(</span>
      text<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'OldBirds'</span></span><span class="token punctuation">,</span>
      style<span class="token punctuation">:</span> <span class="token class-name">TextStyle</span><span class="token punctuation">(</span>
        color<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>blue<span class="token punctuation">,</span>
        fontSize<span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">TextPainter</span> textPainter <span class="token operator">=</span> <span class="token class-name">TextPainter</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> logoSpan<span class="token punctuation">,</span> textDirection<span class="token punctuation">:</span> <span class="token class-name">TextDirection</span><span class="token punctuation">.</span>ltr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    textPainter<span class="token punctuation">.</span><span class="token function">layout</span><span class="token punctuation">(</span>maxWidth<span class="token punctuation">:</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/// 绘制文本</span>
    textPainter<span class="token punctuation">.</span><span class="token function">paint</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>canvas<span class="token punctuation">,</span> <span class="token class-name">Offset</span><span class="token punctuation">(</span><span class="token operator">-</span>textPainter<span class="token punctuation">.</span>size<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span>textPainter<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/// 绘制圆</span>
    context<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span><span class="token function">drawCircle</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> _paint<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>在 CircleLogoRenderBox 我们只处理 paint 进行绘制即可。</p> <p>最后我们在 MainPage 使用 <code>CircleLogoWidget</code>：</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">class</span> <span class="token class-name">MainPage</span> <span class="token keyword">extends</span> <span class="token class-name">StatelessWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
  <span class="token class-name">MainPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Scaffold</span><span class="token punctuation">(</span>
      appBar<span class="token punctuation">:</span> <span class="token class-name">AppBar</span><span class="token punctuation">(</span>
        title<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      body<span class="token punctuation">:</span> <span class="token class-name">Center</span><span class="token punctuation">(</span>
        child<span class="token punctuation">:</span> <span class="token class-name">Opacity</span><span class="token punctuation">(</span>
          child<span class="token punctuation">:</span> <span class="token class-name">CircleLogoWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          opacity<span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      floatingActionButton<span class="token punctuation">:</span> <span class="token class-name">FloatingActionButton</span><span class="token punctuation">(</span>
        onPressed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        tooltip<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'Increment'</span></span><span class="token punctuation">,</span>
        child<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>add<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们借助于 SingleChildRenderObjectWidget 完成自定义 CircleLogoWidget
然后通过使用 TextPainter 来绘制文字， canvans 调用 <code>drawCircle</code> 以 offset 为圆心，半径为 80 绘制了一个圆，完成了我们想要的效果。</p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>本文从 Opcity 的源码的深入解读，再不断的深入源码，引出 RenderObject，然后梳理了 Widget、Element 和 RenderObject 三者之间的关系，更近一步的理解 Flutter 的绘制原理，最后实现了一个可自定义绘制的 Widget。</p> <h2 id="练习"><a href="#练习" class="header-anchor">#</a> 练习</h2> <p>相信看完此片文章，回答以下问题应该是比较容易的</p> <ul><li>build 方法是在什么时候调用的？</li> <li>BuildContext 是什么？</li> <li>Widget 频繁更改创建是否会影响性能？复用和更新机制是什么样的？</li> <li>创建 Widget 里面的 Key 到底是什么作用？</li> <li>state 里面为啥可以直接获取到 widget 对象？</li></ul> <h2 id="参阅"><a href="#参阅" class="header-anchor">#</a> 参阅</h2> <ul><li><a href="https://juejin.cn/post/6845166891539906574" target="_blank" rel="nofollow noopener noreferrer">Flutter 渲染之 Widget、Element 和 RenderObject<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">9/1/2024, 4:34:45 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/flutter/u11-flutter-render.html" class="prev">
          Flutter 是如何渲染的？
        </a></span> <span class="next"><a href="/flutter/u12-flutter-web-01.html">
          Flutter for Web，网络篇
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#从-opcity-触发" class="sidebar-link reco-side-从-opcity-触发" data-v-b57cc07c>从 Opcity 触发</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#renderopacity" class="sidebar-link reco-side-renderopacity" data-v-b57cc07c>RenderOpacity</a></li><li class="level-2" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#singlechildrenderobjectwidget、renderobjectwidget、widget-各类的职责" class="sidebar-link reco-side-singlechildrenderobjectwidget、renderobjectwidget、widget-各类的职责" data-v-b57cc07c>SingleChildRenderObjectWidget、RenderObjectWidget、Widget 各类的职责</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#widget" class="sidebar-link reco-side-widget" data-v-b57cc07c>Widget</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#renderobjectwidget" class="sidebar-link reco-side-renderobjectwidget" data-v-b57cc07c>RenderObjectWidget</a></li><li class="level-2" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#现有的-widget-的继承结构如何" class="sidebar-link reco-side-现有的-widget-的继承结构如何" data-v-b57cc07c>现有的 Widget 的继承结构如何？</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#基本继承关系图" class="sidebar-link reco-side-基本继承关系图" data-v-b57cc07c>基本继承关系图：</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#leafrenderobjectwidget-继承关系图" class="sidebar-link reco-side-leafrenderobjectwidget-继承关系图" data-v-b57cc07c>LeafRenderObjectWidget 继承关系图：</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#singlechildrenderobjectwidget-继承关系图" class="sidebar-link reco-side-singlechildrenderobjectwidget-继承关系图" data-v-b57cc07c>SingleChildRenderObjectWidget 继承关系图</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#mutilchildrenderobjectwidget-继承关系图" class="sidebar-link reco-side-mutilchildrenderobjectwidget-继承关系图" data-v-b57cc07c>MutilChildRenderObjectWidget 继承关系图</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#proxywidget-继承关系图" class="sidebar-link reco-side-proxywidget-继承关系图" data-v-b57cc07c>ProxyWidget 继承关系图</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#statelesswidget-继承关系图" class="sidebar-link reco-side-statelesswidget-继承关系图" data-v-b57cc07c>StatelessWidget 继承关系图</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#statefulwidget-继承关系图" class="sidebar-link reco-side-statefulwidget-继承关系图" data-v-b57cc07c>StatefulWidget 继承关系图</a></li><li class="level-2" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#opacity-只看到-widget-和-renderobject-element-呢" class="sidebar-link reco-side-opacity-只看到-widget-和-renderobject-element-呢" data-v-b57cc07c>Opacity 只看到 Widget 和 RenderObject，Element 呢？</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#widget-树-、renderobject-树、element-树的关系" class="sidebar-link reco-side-widget-树-、renderobject-树、element-树的关系" data-v-b57cc07c>Widget 树 、RenderObject 树、Element 树的关系</a></li><li class="level-2" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#renderproxybox、renderbox、renderobject-各自又都做了什么" class="sidebar-link reco-side-renderproxybox、renderbox、renderobject-各自又都做了什么" data-v-b57cc07c>RenderProxyBox、RenderBox、RenderObject 各自又都做了什么?</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#renderobject" class="sidebar-link reco-side-renderobject" data-v-b57cc07c>RenderObject</a></li><li class="level-3" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#renderbox" class="sidebar-link reco-side-renderbox" data-v-b57cc07c>RenderBox</a></li><li class="level-2" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#自定义-widget" class="sidebar-link reco-side-自定义-widget" data-v-b57cc07c>自定义 Widget</a></li><li class="level-2" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#总结" class="sidebar-link reco-side-总结" data-v-b57cc07c>总结</a></li><li class="level-2" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#练习" class="sidebar-link reco-side-练习" data-v-b57cc07c>练习</a></li><li class="level-2" data-v-b57cc07c><a href="/flutter/u12-flutter-create-w.html#参阅" class="sidebar-link reco-side-参阅" data-v-b57cc07c>参阅</a></li></ul></div></div></div><div class="global-ui"><!----><!----><!----><!----></div></div>
    <script src="/assets/js/app.f5d8099c.js" defer></script><script src="/assets/js/3.fe443068.js" defer></script><script src="/assets/js/2.333abca7.js" defer></script><script src="/assets/js/1.09331013.js" defer></script><script src="/assets/js/136.b2811f5f.js" defer></script><script src="/assets/js/34.36196d0f.js" defer></script>
  </body>
</html>
