(window.webpackJsonp=window.webpackJsonp||[]).push([[322],{783:function(a,t,s){"use strict";s.r(t);var e=s(2),r=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("p",[a._v("用 "),t("code",[a._v("gitlab")]),a._v(" 对内部代码进行私有管理，由于 gitlab 在 MacOS 上的部署太过复杂，所以采用 Ubuntu 虚拟机进行部署。随着项目的不断增多，以及代码的不断迭代，早期给虚拟机规划的 30G 磁盘空间现不够用了，今天出现超容卡死现象。本文就将此扩容过程做下笔记分享给大家，可收藏此文，以便不时之需。")]),a._v(" "),t("blockquote",[t("p",[a._v("使用的 VituralBox 的版本是 "),t("code",[a._v("6.1.22")]),a._v("。")])]),a._v(" "),t("h2",{attrs:{id:"解决超容问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解决超容问题"}},[a._v("#")]),a._v(" 解决超容问题")]),a._v(" "),t("p",[a._v("因为使用的空间超过了 30G，导致虚拟机重启一直失败。")]),a._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[a._v("Started Hold "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("until")]),a._v(" boot procss finishes up\n")])])]),t("p",[a._v("所以首先需要降低磁盘占用，可删除一些大文件或者无用的磁盘空间。")]),a._v(" "),t("p",[a._v("启动 Ubuntu 的时候，选择 "),t("code",[a._v("Advanced options for Ubuntu")])]),a._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502539034334.jpg",loading:"lazy"}})]),a._v(" "),t("blockquote",[t("p",[a._v("怎么进入到 Advanced options for Ubuntu？\n在启动的刚开始的时候，一直"),t("strong",[a._v("按 shift 键")]),a._v("直到进入 GNU GRUB 菜单即可。")])]),a._v(" "),t("p",[a._v("通过上下键选择到"),t("code",[a._v("Ubuntu 高级选项")]),a._v("（英文版：Advanced options for Ubuntu），按 enter 键进入到下一级菜单，然后选择 recovery，选最新的版本的 recovery：")]),a._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502540484712.jpg",loading:"lazy"}})]),a._v(" "),t("p",[a._v("选中 recovery mode 之后，按 enter 键进入下一级菜单。然后选择 clean：")]),a._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502541029388.jpg",loading:"lazy"}})]),a._v(" "),t("p",[a._v("按 enter 键之后开始清理碎片空间，清理之后，重启就可以打开了。")]),a._v(" "),t("blockquote",[t("p",[a._v("如果重启还不行，可以移步到 "),t("a",{attrs:{href:"https://www.codetd.com/article/9986683",target:"_blank",rel:"nofollow noopener noreferrer"}},[a._v("这篇文章"),t("OutboundLink")],1)])]),a._v(" "),t("h2",{attrs:{id:"扩容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#扩容"}},[a._v("#")]),a._v(" 扩容")]),a._v(" "),t("p",[a._v("先给虚拟机分配足够的磁盘空间。")]),a._v(" "),t("p",[t("strong",[a._v("步骤 1：复制虚拟机磁盘驱动器的路径")])]),a._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502546155907.jpg",loading:"lazy"}})]),a._v(" "),t("p",[a._v("复制路径后，在某处记下它，然后关闭 VM 并退出 VirtualBox。")]),a._v(" "),t("p",[t("strong",[a._v("步骤 2：在 MacOS 上打开终端应用程序")])]),a._v(" "),t("p",[a._v("在 MacOS 终端上粘贴以下命令，用来切换到 VirtualBox 应用程序目录：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /Applications/VirtualBox.app/Contents/Resources/VirtualBoxVM.app/Contents/MacOS/\n")])])]),t("p",[t("strong",[a._v("步骤 3：增加 VirtualBox 磁盘驱动器的大小")])]),a._v(" "),t("p",[a._v("可以用下面两种方式增加虚拟内存：")]),a._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[a._v("VBoxManage modifymedium "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"path you copied above"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--resize")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("new size "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 或者")]),a._v("\nVBoxManage modifyhd "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"path you copied above"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--resize")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("new size "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])])]),t("p",[a._v("比如空间设置为 35000MB，那么命令如下：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("VBoxManage modifymedium "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/Users/mimi/VirtualBox VMs/ubantu/ubantu.vdi"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--resize")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("35000")]),a._v("\n")])])]),t("p",[a._v("其中 "),t("code",[a._v("/Users/mimi/VirtualBox VMs/ubantu/ubantu.vdi")]),a._v(" 就是我们步骤 1 拷贝的路径。")]),a._v(" "),t("p",[t("strong",[a._v("步骤 4：重新启动 VirtualBox")])]),a._v(" "),t("p",[a._v("当你在 MACOS 上打开 VirtualBox 时，你会看到 VM 磁盘驱动器的大小增加了。")]),a._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502551698544.jpg",loading:"lazy"}})]),a._v(" "),t("blockquote",[t("p",[a._v("35000MB / 1024 ~= 34.18G")])]),a._v(" "),t("p",[a._v("请记住，虽然你增加了虚拟磁盘的大小，但"),t("strong",[a._v("如果你的空间是动态分配的，那么实际的分区大小仍然不变。")])]),a._v(" "),t("p",[a._v("可以手动将这块新增且未分配的空间分配到磁盘。")]),a._v(" "),t("h2",{attrs:{id:"改变实际分区的空间大小"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#改变实际分区的空间大小"}},[a._v("#")]),a._v(" 改变实际分区的空间大小")]),a._v(" "),t("p",[t("strong",[a._v("步骤 1：安装磁盘管理工具 "),t("code",[a._v("gparted")]),a._v("：")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("gparted")]),a._v("\n")])])]),t("p",[t("strong",[a._v("步骤 2：打开磁盘管理工具")])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("gparted")]),a._v("\n")])])]),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502602095545.jpg",loading:"lazy"}})]),a._v(" "),t("p",[a._v("然后可以看到有你自己的分区和未分配分区，选择自己的分区然后鼠标右键选择“Resize/Move”，将未分配空间全部添加给你的分区。")]),a._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502603166680.jpg",loading:"lazy"}})]),a._v(" "),t("p",[a._v("点击编辑，选择“应用全部操作”，等待操作完成即可")]),a._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502603838579.jpg",loading:"lazy"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);