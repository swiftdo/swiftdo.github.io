(window.webpackJsonp=window.webpackJsonp||[]).push([[355],{816:function(t,s,n){"use strict";n.r(s);var a=n(2),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"背景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[t._v("#")]),t._v(" 背景")]),t._v(" "),s("p",[t._v("随着文档数量的增加，Vuepress 在 ci 构建的可能就会出现 node 内存泄露。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),t._v(" Rendering static HTML"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("--- Last few GCs ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5553")]),t._v(":0x6387c80"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("117350")]),t._v(" ms: Scavenge "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reduce"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2014.0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2083.8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" -"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2013.7")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2084.3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" MB, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.0")]),t._v(" / "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(" ms  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("average mu "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.125")]),t._v(", current mu "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.003")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" allocation failure\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5553")]),t._v(":0x6387c80"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("120580")]),t._v(" ms: Mark-sweep "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reduce"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2014.3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2084.3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" -"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2013.0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2084.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" MB, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3224.1")]),t._v(" / "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(" ms  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("average mu "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.080")]),t._v(", current mu "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.032")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" allocation failure scavenge might not succeed\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("--- JS stacktrace ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nFATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": 0xb00d90 node::Abort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/home/travis/.nvm/versions/node/v16.13.1/bin/node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(": 0xa1823b node::FatalError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("char const*, char const*"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/home/travis/.nvm/versions/node/v16.13.1/bin/node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(": 0xcedbce v8::Utils::ReportOOMFailure"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v8::internal::Isolate*, char const*, bool"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/home/travis/.nvm/versions/node/v16.13.1/bin/node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(": 0xcedf47 v8::internal::V8::FatalProcessOutOfMemory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v8::internal::Isolate*, char const*, bool"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/home/travis/.nvm/versions/node/v16.13.1/bin/node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(": 0xea6105  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/home/travis/.nvm/versions/node/v16.13.1/bin/node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(": 0xea6be6  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/home/travis/.nvm/versions/node/v16.13.1/bin/node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(": 0xeb4b1e  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/home/travis/.nvm/versions/node/v16.13.1/bin/node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(": 0xeb5560 v8::internal::Heap::CollectGarbage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v8::internal::AllocationSpace, v8::internal::GarbageCollectionReason, v8::GCCallbackFlags"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/home/travis/.nvm/versions/node/v16.13.1/bin/node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(": 0xeb84de v8::internal::Heap::AllocateRawWithRetryOrFailSlowPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int, v8::internal::AllocationType, v8::internal::AllocationOrigin, v8::internal::AllocationAlignment"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/home/travis/.nvm/versions/node/v16.13.1/bin/node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(": 0xe7990a v8::internal::Factory::NewFillerObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int, bool, v8::internal::AllocationType, v8::internal::AllocationOrigin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/home/travis/.nvm/versions/node/v16.13.1/bin/node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(": 0x11f2f06 v8::internal::Runtime_AllocateInYoungGeneration"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int, unsigned long*, v8::internal::Isolate*"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/home/travis/.nvm/versions/node/v16.13.1/bin/node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(": 0x15e7819  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/home/travis/.nvm/versions/node/v16.13.1/bin/node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nAborted\nerror Command failed with "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v(" code "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("134")]),t._v(".\ninfo Visit https://yarnpkg.com/en/docs/cli/run "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" documentation about this command.\nThe "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yarn docs:build"')]),t._v(" exited with "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("134")]),t._v(".\ncache.2\nstore build cache\n")])])]),s("h2",{attrs:{id:"解决方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[t._v("#")]),t._v(" 解决方案")]),t._v(" "),s("p",[t._v("在 package.json 修改配置：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// package.json 配置")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"docs:build"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node --max_old_space_size=4096 ./node_modules/vuepress/cli.js build docs"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("p",[t._v("修改了 docs:build 的执行语句，指定了内存为 4096。")])])}),[],!1,null,null,null);s.default=e.exports}}]);