(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{772:function(t,a,s){"use strict";s.r(a);var e=s(8),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("本文，我们将使用 Github Actions 上构建 Flutter 应用， 用 Github Pages 托管。")]),t._v(" "),s("p",[t._v("Github 刚刚发布了另一个名为 Actions 的功能。它可以帮助我们对项目进行 CI＆CD 集成。")]),t._v(" "),s("h2",{attrs:{id:"flutter-web"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flutter-web"}},[t._v("#")]),t._v(" Flutter Web")]),t._v(" "),s("p",[t._v("第一步就是创建一个 flutter web 应用。我们需要使用 Flutter 的 beta、master、dev 其中的的一个 channel 来进行创建 web 项目。")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("$ flutter channel master\n$ flutter upgrade\n$ flutter config --enable-web\n")])])]),s("p",[t._v("我们创建个 "),s("code",[t._v("flutter_web")]),t._v(" 项目")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("$ flutter create flutter_web\n$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" flutter_web\n$ flutter run -d chrome\n")])])]),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"-w759","data-src":"http://blog.loveli.site/2019-12-23-15770764808850.png",loading:"lazy"}})]),t._v(" "),s("p",[t._v("项目这边完工，那么如何用 github page 托管呢？")]),t._v(" "),s("h2",{attrs:{id:"github"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#github"}},[t._v("#")]),t._v(" Github")]),t._v(" "),s("h3",{attrs:{id:"创建一个-repository"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建一个-repository"}},[t._v("#")]),t._v(" 创建一个 repository")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"-w162","data-src":"http://blog.loveli.site/2019-12-23-15770767088539.png",loading:"lazy"}})]),t._v(" "),s("p",[t._v("创建好后，将本地项目提交上去。")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" init\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" --all\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -m "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"first commit"')]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" remote "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" origin https://github.com/OHeroJ/flutter_web.git\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push -u origin master\n")])])]),s("h3",{attrs:{id:"gh-pages"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gh-pages"}},[t._v("#")]),t._v(" Gh-Pages")]),t._v(" "),s("p",[t._v("如何启用 Gh-Pages ？")]),t._v(" "),s("p",[t._v("我们需要将编译好的文件放到 "),s("code",[t._v("origin/gh-pages")]),t._v(" 这个分支，然后 Github 会将这些文件作为一个站点，")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("username.github.io/repository_name\n")])])]),s("p",[t._v("通过上面的 URL 进行访问。")]),t._v(" "),s("h3",{attrs:{id:"github-actions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#github-actions"}},[t._v("#")]),t._v(" Github Actions")]),t._v(" "),s("p",[t._v("我们将创建一个 Action 来构建和发布 Flutter Web 项目，但是我们需要一个 access token，这样运行 Action 的那台机器可以进行提交。")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.loveli.site/2019-12-23-13_08_13__12_23_2019.jpg",loading:"lazy"}})]),t._v(" "),s("p",[t._v("拷贝这个生成的 token。你切换到其他页面就看不到了")]),t._v(" "),s("p",[s("strong",[t._v("Secrets")])]),t._v(" "),s("p",[t._v("然后需要在项目的设置里设置好 Secrets")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"-w864","data-src":"http://blog.loveli.site/2019-12-23-15770780677496.png",loading:"lazy"}})]),t._v(" "),s("p",[t._v("添加一个 name 为 "),s("code",[t._v("commit_secret")]),t._v(", value 是刚才我们创建的 token。")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"Screen Shot 2019-12-23 at 1.17.32 P","data-src":"http://blog.loveli.site/2019-12-23-Screen%20Shot%202019-12-23%20at%201.17.32%20PM.png",loading:"lazy"}})]),t._v(" "),s("p",[s("strong",[t._v("flutter_build_publish_web.yml")])]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"Screen Shot 2019-12-23 at 1.22.05 P","data-src":"http://blog.loveli.site/2019-12-23-Screen%20Shot%202019-12-23%20at%201.22.05%20PM.png",loading:"lazy"}})]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Flutter Web\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" master\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Build Web\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("my_secret")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("secrets.commit_secret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v1\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" subosito/flutter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@v1\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("channel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dev'")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" flutter config "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("enable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("web\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" flutter pub get\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" flutter build web "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("release\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token scalar string"}},[t._v('\n          cd build/web\n          git init\n          # type configurations: your user.email and user.name followed lines \n          # git config --global user.email your_email \n          # git config --global user.name your_name \n          git config --global user.email 1164258202@qq.com\n          git config --global user.name oheroj\n          git status\n          # change this remote url for examle your remote url is https://github.com/onatcipli/flutter_web.git then the following:\n          git remote add origin https://${{secrets.commit_secret}}@github.com/oheroj/flutter_web.git\n          git checkout -b gh-pages\n          git add --all\n          git commit -m "update"\n          git push origin gh-pages -f')]),t._v("\n")])])]),s("p",[t._v("上面是我项目的配置，所以在你的项目中这三处")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[t._v("git config "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("global user.email 1164258202@qq.com\ngit config "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("global user.name oheroj\n\ngit remote add origin https"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("secrets.commit_secret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("@github.com/oheroj/flutter_web.git\n")])])]),s("p",[t._v("需要进行修改成你自己的项目的配置。")]),t._v(" "),s("p",[t._v("完成这些更改后，我们就可以开始了！点击提交到到主分支上即可。这会自动触发这个 Action。")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"Screen Shot 2019-12-23 at 1.36.25 P","data-src":"http://blog.loveli.site/2019-12-23-Screen%20Shot%202019-12-23%20at%201.36.25%20PM.png",loading:"lazy"}})]),t._v(" "),s("p",[t._v("构建完成后，我们看看效果，直接在浏览器输入 'https://oheroj.github.io/flutter_web'")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"Screen Shot 2019-12-23 at 1.40.03 P","data-src":"http://blog.loveli.site/2019-12-23-Screen%20Shot%202019-12-23%20at%201.40.03%20PM.png",loading:"lazy"}})]),t._v(" "),s("blockquote",[s("p",[t._v("为什么会是 liveli.site， 因为我做了 cname。")])]),t._v(" "),s("p",[t._v("那本文到此结束。你 get 到新技能了么？")])])}),[],!1,null,null,null);a.default=n.exports}}]);