(window.webpackJsonp=window.webpackJsonp||[]).push([[270],{947:function(t,a,s){"use strict";s.r(a);var e=s(8),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("用 "),s("code",[t._v("gitlab")]),t._v(" 对内部代码进行私有管理，由于 gitlab 在 MacOS 上的部署太过复杂，所以采用 Ubuntu 虚拟机进行部署。随着项目的不断增多，以及代码的不断迭代，早期给虚拟机规划的 30G 磁盘空间现不够用了，今天出现超容卡死现象。本文就将此扩容过程做下笔记分享给大家，可收藏此文，以便不时之需。")]),t._v(" "),s("blockquote",[s("p",[t._v("使用的 VituralBox 的版本是 "),s("code",[t._v("6.1.22")]),t._v("。")])]),t._v(" "),s("h2",{attrs:{id:"解决超容问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决超容问题"}},[t._v("#")]),t._v(" 解决超容问题")]),t._v(" "),s("p",[t._v("因为使用的空间超过了 30G，导致虚拟机重启一直失败。")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("Started Hold "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("until")]),t._v(" boot procss finishes up\n")])])]),s("p",[t._v("所以首先需要降低磁盘占用，可删除一些大文件或者无用的磁盘空间。")]),t._v(" "),s("p",[t._v("启动 Ubuntu 的时候，选择 "),s("code",[t._v("Advanced options for Ubuntu")])]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502539034334.jpg",loading:"lazy"}})]),t._v(" "),s("blockquote",[s("p",[t._v("怎么进入到 Advanced options for Ubuntu？\n在启动的刚开始的时候，一直"),s("strong",[t._v("按 shift 键")]),t._v("直到进入 GNU GRUB 菜单即可。")])]),t._v(" "),s("p",[t._v("通过上下键选择到"),s("code",[t._v("Ubuntu 高级选项")]),t._v("（英文版：Advanced options for Ubuntu），按 enter 键进入到下一级菜单，然后选择 recovery，选最新的版本的 recovery：")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502540484712.jpg",loading:"lazy"}})]),t._v(" "),s("p",[t._v("选中 recovery mode 之后，按 enter 键进入下一级菜单。然后选择 clean：")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502541029388.jpg",loading:"lazy"}})]),t._v(" "),s("p",[t._v("按 enter 键之后开始清理碎片空间，清理之后，重启就可以打开了。")]),t._v(" "),s("blockquote",[s("p",[t._v("如果重启还不行，可以移步到 "),s("a",{attrs:{href:"https://www.codetd.com/article/9986683",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("这篇文章"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"扩容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#扩容"}},[t._v("#")]),t._v(" 扩容")]),t._v(" "),s("p",[t._v("先给虚拟机分配足够的磁盘空间。")]),t._v(" "),s("p",[s("strong",[t._v("步骤 1：复制虚拟机磁盘驱动器的路径")])]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502546155907.jpg",loading:"lazy"}})]),t._v(" "),s("p",[t._v("复制路径后，在某处记下它，然后关闭 VM 并退出 VirtualBox。")]),t._v(" "),s("p",[s("strong",[t._v("步骤 2：在 MacOS 上打开终端应用程序")])]),t._v(" "),s("p",[t._v("在 MacOS 终端上粘贴以下命令，用来切换到 VirtualBox 应用程序目录：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /Applications/VirtualBox.app/Contents/Resources/VirtualBoxVM.app/Contents/MacOS/\n")])])]),s("p",[s("strong",[t._v("步骤 3：增加 VirtualBox 磁盘驱动器的大小")])]),t._v(" "),s("p",[t._v("可以用下面两种方式增加虚拟内存：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("VBoxManage modifymedium "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path you copied above"')]),t._v(" --resize "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("new size "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" MB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者")]),t._v("\nVBoxManage modifyhd "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path you copied above"')]),t._v(" --resize "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("new size "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" MB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[t._v("比如空间设置为 35000MB，那么命令如下：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("VBoxManage modifymedium "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/Users/mimi/VirtualBox VMs/ubantu/ubantu.vdi"')]),t._v(" --resize "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("35000")]),t._v("\n")])])]),s("p",[t._v("其中 "),s("code",[t._v("/Users/mimi/VirtualBox VMs/ubantu/ubantu.vdi")]),t._v(" 就是我们步骤 1 拷贝的路径。")]),t._v(" "),s("p",[s("strong",[t._v("步骤 4：重新启动 VirtualBox")])]),t._v(" "),s("p",[t._v("当你在 MACOS 上打开 VirtualBox 时，你会看到 VM 磁盘驱动器的大小增加了。")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502551698544.jpg",loading:"lazy"}})]),t._v(" "),s("blockquote",[s("p",[t._v("35000MB / 1024 ~= 34.18G")])]),t._v(" "),s("p",[t._v("请记住，虽然你增加了虚拟磁盘的大小，但"),s("strong",[t._v("如果你的空间是动态分配的，那么实际的分区大小仍然不变。")])]),t._v(" "),s("p",[t._v("可以手动将这块新增且未分配的空间分配到磁盘。")]),t._v(" "),s("h2",{attrs:{id:"改变实际分区的空间大小"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#改变实际分区的空间大小"}},[t._v("#")]),t._v(" 改变实际分区的空间大小")]),t._v(" "),s("p",[s("strong",[t._v("步骤 1：安装磁盘管理工具 "),s("code",[t._v("gparted")]),t._v("：")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gparted")]),t._v("\n")])])]),s("p",[s("strong",[t._v("步骤 2：打开磁盘管理工具")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gparted")]),t._v("\n")])])]),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502602095545.jpg",loading:"lazy"}})]),t._v(" "),s("p",[t._v("然后可以看到有你自己的分区和未分配分区，选择自己的分区然后鼠标右键选择“Resize/Move”，将未分配空间全部添加给你的分区。")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502603166680.jpg",loading:"lazy"}})]),t._v(" "),s("p",[t._v("点击编辑，选择“应用全部操作”，等待操作完成即可")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"","data-src":"http://blog.oldbird.run/mweb/16502603838579.jpg",loading:"lazy"}})])])}),[],!1,null,null,null);a.default=r.exports}}]);